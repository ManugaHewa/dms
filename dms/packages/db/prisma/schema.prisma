generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Donor {
  id           String   @id @default(cuid())
  firstName    String
  lastName     String
  email        String?
  mobile       String?
  address1     String?
  city         String?
  province     String?
  postalCode   String?
  country      String?  @default("Canada")
  donations    Donation[]
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Cause {
  id        String    @id @default(cuid())
  name      String    @unique
  active    Boolean   @default(true)
  donations Donation[]
}

model Donation {
  id            String   @id @default(cuid())
  donor         Donor?   @relation(fields: [donorId], references: [id])
  donorId       String?
  cause         Cause    @relation(fields: [causeId], references: [id])
  causeId       String
  type          DonationType
  currency      String   @default("CAD")
  grossAmount   Decimal  @db.Decimal(12,2)
  processorFee  Decimal? @db.Decimal(12,2)
  netAmount     Decimal  @db.Decimal(12,2)
  status        DonationStatus @default(PENDING_VALIDATION)
  dateRecorded  DateTime @default(now())
  dateVerified  DateTime?
  remarksDonor  String?
  remarksTemple String?
  receipt       Receipt?
}

enum DonationType {
  CASH
  CHEQUE
  CARD
  INTERAC
  EFT
  CANADAHELPS
  IN_KIND
}

enum DonationStatus {
  PENDING_VALIDATION
  VALIDATED
  VOID
}

model Receipt {
  id            String   @id @default(cuid())
  donation      Donation @relation(fields: [donationId], references: [id])
  donationId    String   @unique
  receiptNumber String   @unique
  issuedAt      DateTime @default(now())
  pdfUrl        String?
}
